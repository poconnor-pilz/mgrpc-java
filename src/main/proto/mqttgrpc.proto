syntax = "proto3";

package com.pilz.mqttgrpc;

option java_multiple_files = true;
option java_package = "com.pilz.mqttgrpc";
option java_outer_classname = "MqttGrpc";



message MgMessage {
  //Every message must have a unique request id
  string requestId = 1;
  //if completed=true then contents will be StatusProto otherwise contents will be
  //input or output type of the method
  bool completed = 2;
  //The message contents
  bytes contents = 3;
}


message MgRequest {
  //The topic to which to send replies
  string replyTo = 1;

  //This can be got from MethodDescriptor.toProto()
  //This will only be set for first message in a client stream
  //MethodDescriptorProto methodDescriptor = 2;

  //Somehow encode the key value pairs of context here
  //This will only be set for first message in a client stream
  //Context context;

  MgMessage message = 2;
}


//The connection status of a server. Sent to an mqtt LWT topic
//When a service is connected it sends this message with connected = true
//Note that many of these messages may be sent (one for each service in a server) but they are idempotent.
//When a server is disconnected this message will automatically be sent as the topic for the connection status
//will be the LWT for the server.
message ConnectionStatus{
  bool connected = 1;
}

//A response containing the topic on which connection status will be sent
//The client will send an empty message to the serviceBaseTopic/connectionStatus and receive this response
//The client can then listen for ConnectionStatus messages at this topic.
message ConnectionStatusResponse{
  bool ok = 2;
  string connectionStatusTopic = 1;
  string errorMessage = 3;
}
